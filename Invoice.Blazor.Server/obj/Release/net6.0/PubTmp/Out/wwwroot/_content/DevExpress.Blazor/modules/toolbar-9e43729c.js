import{D as t}from"./dom-166a04be.js";import{e,k as i,l as s,E as o,R as n,f as r,u as l,F as a,G as d}from"./dom-utils-7f5be2f0.js";import{d as h}from"./disposable-d2c2d283.js";import{S as u}from"./observables-589a5615.js";import{initFocusHidingEvents as c}from"./focus-utils-ca557877.js";import{P as m}from"./supportcaptureelement-51f73fdc.js";import{D as p}from"./dx-ui-element-de378e9d.js";import{P as g}from"./getPopupRootSingleton-f8347fe3.js";import{i as b}from"./logicaltreehelper-15991dcb.js";import{d as f,e as y}from"./popup-e5c1aca3.js";import{E as v}from"./eventhelper-8570b930.js";import{$ as w}from"./lit-element-b0a6fcba.js";import{T as C}from"./toolbar-css-classes-98be7512.js";import"./_tslib-6e8ca86b.js";import"./css-classes-f3f8ed66.js";import"./touch-f4b0b277.js";import"./lit-element-base-af247167.js";import"./data-qa-utils-8be7c726.js";import"./branch-2ea85171.js";import"./property-d3853089.js";import"./custom-element-bd7061f2.js";import"./capturemanager-91fa2b2d.js";import"./layouthelper-4b19d191.js";import"./rect-7fc5c2ef.js";import"./point-9c6ab88a.js";import"./rafaction-bba7928b.js";import"./transformhelper-ebad0156.js";import"./positiontracker-dba18a16.js";import"./nameof-factory-64d95f5b.js";import"./custom-events-helper-18f7786a.js";class D extends p{constructor(){super(),this.boundOnDropDownElementChangedHandler=this.onDropDownElementChanged.bind(this),this.boundOnDropDownShownHandler=this.onDropDownShown.bind(this),this.boundOnDropDownClosedHandler=this.onDropDownClosed.bind(this),this.boundOnDropDownPortalElementsChangedHandler=this.onDropDownPortalElementsChanged.bind(this),this.boundSlotChangedHandler=this.onSlotChanged.bind(this),this.dropDownPortal=null,this._dropDownElement=null,this._adaptiveDropDownElement=null}get dropDownElement(){return this._dropDownElement}get useMobileFocusBehaviour(){var t;return(null===(t=this._adaptiveDropDownElement)||void 0===t?void 0:t.adaptivityEnabled)||!1}connectedCallback(){super.connectedCallback(),this.ensureDropDownInfrastructure(),this.addEventListener(g.eventName,this.boundOnDropDownElementChangedHandler)}disconnectedCallback(){this.removeEventListener(g.eventName,this.boundOnDropDownElementChangedHandler),this.disposeDropDownInfrastructure(),super.disconnectedCallback()}render(){return w`
            <slot @slotchange="${this.boundSlotChangedHandler}">
            </slot>
        `}processCapturedKeyDownAsync(t,e){return this.invokeKeyDownServerCommand(t)?(t.preventDefault(),e.handled=!0,Promise.resolve()):super.processCapturedKeyDownAsync(t,e)}processCapturedPointerDownAsync(t,e){return this.canHandlePointerDown(t)?(e.handled=!0,Promise.resolve()):super.processCapturedPointerDownAsync(t,e)}canHandlePointerDown(t){return!1}invokeKeyDownServerCommand(t){return!1}onSlotChanged(t){this.disposeDropDownInfrastructure(),this.ensureDropDownInfrastructure()}getDropDownPortal(){if(!this.shadowRoot)return null;const t=this.shadowRoot.querySelector("slot");if(!t)return null;return t.assignedNodes().find((t=>b(t,(()=>["popup","addEventListener","removeEventListener"]))))}onDropDownElementChanged(t){v.getOriginalSource(t)===this.dropDownPortal&&(this.disposeDropDownElement(),this.ensureDropDownElement())}onDropDownShown(t){this.dropDownElement&&b(this.dropDownElement,(()=>["logicalParent"]))&&this.addLogicalChild(this.dropDownElement)}onDropDownClosed(t){this.dropDownElement&&b(this.dropDownElement,(()=>["logicalParent"]))&&this.removeLogicalChild(this.dropDownElement)}onDropDownPortalElementsChanged(t){this.ensureDropDownElement()}ensureDropDownInfrastructure(){var t;this.dropDownPortal=this.getDropDownPortal(),null===(t=this.dropDownPortal)||void 0===t||t.addEventListener(g.eventName,this.boundOnDropDownPortalElementsChangedHandler),this.ensureDropDownElement()}ensureDropDownElement(){var t,e,i;this.dropDownPortal&&(this._dropDownElement=null===(t=this.dropDownPortal)||void 0===t?void 0:t.popup,null===(e=this._dropDownElement)||void 0===e||e.addEventListener(f.eventName,this.boundOnDropDownShownHandler),null===(i=this._dropDownElement)||void 0===i||i.addEventListener(y.eventName,this.boundOnDropDownClosedHandler),this._dropDownElement&&b(this._dropDownElement,(()=>["adaptivityEnabled"]))&&(this._adaptiveDropDownElement=this._dropDownElement))}disposeDropDownInfrastructure(){var t;null===(t=this.dropDownPortal)||void 0===t||t.removeEventListener(g.eventName,this.boundOnDropDownPortalElementsChangedHandler),this.dropDownPortal=null,this._adaptiveDropDownElement=null,this.disposeDropDownElement()}disposeDropDownElement(){var t,e;null===(t=this._dropDownElement)||void 0===t||t.removeEventListener(f.eventName,this.boundOnDropDownShownHandler),null===(e=this._dropDownElement)||void 0===e||e.removeEventListener(y.eventName,this.boundOnDropDownClosedHandler),this._dropDownElement=null}}const k=".dxbl-image:not(.dxbl-toolbar-dropdown-toggle)";class x{constructor(t){this.items=[],this.isLocked=!1,this.subscriptions=[],t&&this.addRange(t)}subscribe(t){this.isLocked||t(this.getChanges(this.items,[])),this.subscriptions.push(t)}getChanges(t,e){return{addedItems:t||[],removedItems:e||[]}}forEach(t,e){this.items.forEach(t,e)}selectMany(t,e){return this.map(t,e).reduce((function(t,e){return t.concat(e)}),[])}reduce(t,e){return this.items.reduce(t,e)}map(t,e){return this.items.map(t,e)}filter(t,e){return this.items.filter(t,e)}any(){return this.count()>0}count(){return this.items.length}get(t){return this.items[t]}add(t){this.addItemCore(t)&&this.raiseChanges([t],[])}remove(t){this.removeItemCore(t)&&this.raiseChanges([],[t])}addRange(t){this.raiseChanges(t.map(this.addItemCore.bind(this)).filter((function(t){return!!t})),[])}removeRange(t){this.raiseChanges([],t.map(this.removeItemCore.bind(this)).filter((function(t){return!!t})))}addItemCore(t){return this.items.indexOf(t)>-1?null:this.items[this.items.length]=t}removeItemCore(t){const e=this.items.indexOf(t);return-1===e?null:this.items.splice(e,1)[0]}raiseChanges(t,e){const i=this.getChanges(t,e);(i.addedItems.length>0||i.removedItems.length>0)&&this.subscriptions.forEach((function(t){t(i)}))}lock(){this.isLocked=!0}unlock(){this.isLocked=!1}}class E{constructor(t,e,i){var s;this.layer=t,this.block=e,this.width=0,this._blockCollection=void 0;const o=e.getGroupElement();o&&(this._blockCollection=this.layer.getBlockCollection(o),null===(s=this._blockCollection)||void 0===s||s.push(e)),i.subscribe(e,((t,i=!1)=>{var s;null===t&&(t=null===(s=this.layer.getPrevLayer())||void 0===s?void 0:s.getActualBlocks().filter((function(t){return t.block===e}))[0].width),t!==this.width&&(this.width=null!=t?t:0,i||this.layer.requestUpdateLayoutModel())}))}get blockCollection(){return this._blockCollection||new I(null)}getMinWidth(){return this.width}getMaxWidth(t){return this.getMinWidth()}}class L extends E{getPrevLayerMinWidth(){const t=this.layer.getPrevLayer();return t?t.getActualBlocks().filter((t=>t.block===this.block))[0].getMinWidth():0}getMaxWidth(t){return t===this.layer?this.getPrevLayerMinWidth():this.getMinWidth()}}class I{constructor(t){this.id=t,this._margins=void 0,this.blocks=[]}push(t){this.blocks.includes(t)||this.blocks.push(t),this.update()}toArray(){return Array.from(this.blocks)}get margins(){return this._margins||0}update(){if(!this._margins&&this.blocks.length){const e=this.blocks[0].getGroupElement();if(e){const i=t.getCurrentStyle(e);this._margins=t.pxToInt(i.marginRight)+t.pxToInt(i.marginLeft)}}}}class S extends E{}class M extends E{}class W{constructor(t,e){this.widthCalculator=t,this.triggersResolver=e,this.widthCalculator=t,this.triggersResolver=e}subscribe(t,e){const i=this.widthCalculator.bind(this);this.triggersResolver(t).forEach((function(s){s.subscribe((function(){t.isWidthCalculationLocked||o((function(){e(i(t),!1)}))}),!0)})),o((function(){e(i(t),!0)}))}}const P={fullWidthItem:new W((function(t){return t.getWidth()}),X),fullWidthSystemItem:new W((function(t){return t.getWidth()}),(function(t){return[]})),titleItem:new W((function(t){return t.getWidth()}),(function(t){var e,i;return[null===(e=t.toolbar.title)||void 0===e?void 0:e.hasTitle,null===(i=t.toolbar.title)||void 0===i?void 0:i.text]})),noTextItem:new W((function(t){return t.getNoTextWidth()}),X),contextItem:function(t){return new W((function(e){return t.items.filter((function(t){return"item"===t.getName()&&t.index<e.index&&t.isVisible()})).length>=e.toolbar.minRootItems||!e.isVisible()?0:null}),X)},hiddenItem:new W((function(){return 0}),(function(){return[]}))};class R{constructor(t,e,i,s){this.stateName=t,this.blockUpdaterGetter=e,this.prevLayer=i,this.canApply=s,this.nextLayer=null,this.layoutBlocks=[],this.nextLayer=null,i&&(i.nextLayer=this)}getNextLayer(){return null!=this.nextLayer?this.nextLayer.canApply()?this.nextLayer:this.nextLayer.getNextLayer():null}getPrevLayer(){return null!=this.prevLayer?this.prevLayer.canApply()?this.prevLayer:this.prevLayer.getPrevLayer():null}requestUpdateLayoutModel(){var t;null===(t=this.getPrevLayer())||void 0===t||t.requestUpdateLayoutModel()}getBlockCollection(t){var e;return null===(e=this.getPrevLayer())||void 0===e?void 0:e.getBlockCollection(t)}isValidWidth(t){if(!this.canApply()||!t)return!1;const e=this.getRange();return!this.getNextLayer()&&e.min>t||!this.getPrevLayer()&&e.max<t||e.min<=t&&e.max>=t}getRange(){const t=new Set,e=this.latestRange=this.getActualBlocks().reduce(((e,i)=>(t.add(i.blockCollection),{min:e.min+i.getMinWidth(),max:e.max+i.getMaxWidth(this)})),{min:0,max:0});return t.forEach((t=>{e.min+=t.margins,e.max+=t.margins})),e}getActualBlocks(){const t=this.getPrevLayer();return t?t.getActualBlocks().map((t=>this.layoutBlocks.filter((function(e){return e.block===t.block}))[0]||t)):this.layoutBlocks}activate(t){t&&this.layoutBlocks.forEach((t=>{t.block.updateState(this.stateName)}))}addBlock(t){const e=this.blockUpdaterGetter(t);e&&this.layoutBlocks.push(this.createBlock(t,e))}removeBlock(t){}activateAndReset(t){}}class T extends R{constructor(t,e,i,s){super(t,e,null,s),this.layoutModel=i,this.blockCollection=new Map}requestUpdateLayoutModel(){this.layoutModel.updateLayout()}createBlock(t,e){return new M(this,t,e)}activateAndReset(t){this.activate(t),this.layoutBlocks.forEach((t=>{t.block.reset()}))}getBlockCollection(t){return this.getBlockCollectionCore(t)}getBlockCollectionCore(t){let e=this.blockCollection.get(t);return e||this.blockCollection.set(t,e=new I(t)),e}}class B extends R{activate(t){const e=this.getActualBlocks();let i=this.latestRange.max,s=this.stateName;const o=new Map;for(let n=e.length-1;n>=0;n--){const r=e[n];if(i>t){i-=r.getMaxWidth(this)-r.getMinWidth();const e=r.blockCollection.id,n=(o.has(e)?o:o.set(e,r.blockCollection.toArray())).get(e);if(n&&(n.splice(n.indexOf(r.block),1),n.length||(i-=r.blockCollection.margins)),i<=t){r.block.updateState(s);const t=this.getPrevLayer();s=t?t.stateName:"";continue}}r.block.updateState(s)}}getRange(){const t=new Set;return this.latestRange=this.getActualBlocks().reduce(((e,i)=>(t.add(i.blockCollection),{min:e.min+i.getMinWidth(),max:e.max+i.getMaxWidth(this)})),{min:0,max:0}),t.forEach((t=>{this.latestRange.max+=t.margins})),this.latestRange}createBlock(t,e){return new L(this,t,e)}}class N extends R{createBlock(t,e){return new S(this,t,e)}getRange(){const t=new Set;let e=this.getActualBlocks().reduce((function(e,i){return t.add(i.blockCollection),e+i.getMinWidth()}),0);t.forEach((t=>{e+=t.margins}));const i=this.getPrevLayerRangeMax();return this.latestRange={min:e,max:i}}getPrevLayerRangeMax(){const t=this.getPrevLayer();return t?t.getRange().max-1:0}}class A{constructor(t){this.onLayerApplied=t,this.layers=[],this.currentWidth=null,this.currentHeight=null}initialize(t,e,i){this.elementContentWidthSubscription=r(e,(e=>{this.currentWidth===e.width&&this.currentHeight===e.height||(null===this.currentWidth&&t.subscribe((t=>{t.addedItems.forEach(this.addBlock.bind(this)),t.removedItems.forEach(this.removeBlock.bind(this))})),this.currentWidth=e.width,this.currentHeight=e.height,i&&i(e))}))}dispose(){this.elementContentWidthSubscription&&l(this.elementContentWidthSubscription)}getLastLayer(){return this.layers[this.layers.length-1]||null}defaultLayer(t,e){this.layers.push(new T("default",t,this,e))}simultaneousTransitionLayer(t,e,i){this.layers.push(new N(t,e,this.getLastLayer(),i))}sequentialTransitionLayer(t,e,i){this.layers.push(new B(t,e,this.getLastLayer(),i))}addBlock(t){this.layers.forEach((function(e){e.addBlock(t)}))}removeBlock(t){this.layers.forEach((function(e){e.removeBlock(t)}))}updateLayout(){const t=this.findLayersForWidth(this.currentWidth);t.length>0&&this.applyLayer(t[0])}resetToDefault(){this.applyLayer(this.layers[0],!0)}applyLayer(t,e=!1){e?t.activateAndReset(this.currentWidth):t.activate(this.currentWidth),this.onLayerApplied&&this.onLayerApplied(t)}findLayersForWidth(t){return this.layers.filter((function(e){return e.isValidWidth(t)}))}forceUpdate(){null!==this.currentWidth&&this.updateLayout()}}class H{constructor(t){this.toolbar=t,this.state="",this._isWidthCalculationLocked=!1,this.index=-1}getWidth(){return this.isVisible()?Y(this.getElement(),!1,false):0}getNoTextWidth(){return this.getWidth()}isVisible(){return!0}get isWidthCalculationLocked(){return this._isWidthCalculationLocked}updateState(t){this.state=t,this.updateStateCore(t)}updateStateCore(t){}lockWidthCalculation(){this._isWidthCalculationLocked=!0}unlockWidthCalculation(){this._isWidthCalculationLocked=!1}getGroupElement(){return null}reset(){}}class V extends H{constructor(t,e){super(t),this.item=e}getElement(){return this.item.getElement()}updateStateCore(t){this.item.isDisplayed.update(t.indexOf("has-"+this.getName())>-1)}updateVisible(t){t||this.lockWidthCalculation(),this.item.updateVisible(t),t&&this.unlockWidthCalculation()}}class j extends V{constructor(t,e){super(t,e)}getNoTextWidth(){return this.item.isDisplayed.value?function(e){let i=Y(e,!1,false);if(e){const s=e.querySelector(k);if(s){i-=Z(s);let e=s;for(;e=e.nextElementSibling;)tt(e)||"absolute"===t.getCurrentStyle(e).position||(i-=Y(e))}}return i}(this.getElement()):0}getName(){return"item"}isVisible(){return this.item.isDisplayed.value}updateStateCore(t){const e=this.item.toolbar,i=-1===t.indexOf(C.ToolbarHasEllipsis);this.updateVisible(e.minRootItems>0?i||this.index<e.minRootItems:i)}getGroupElement(){return this.item.getGroupElement()}}class _ extends V{constructor(t,e){super(t,e)}getName(){return"ellipsis"}updateStateCore(t){super.updateStateCore(t),this.updateVisible(this.item.isDisplayed.value)}reset(){this.updateVisible(!0)}}class q extends j{constructor(t,e){super(t,e),this.itemBlocks=[],this.addItem(e)}addItem(t){this.itemBlocks.push(new j(this.toolbar,t))}isVisible(){return this.itemBlocks.reduce((function(t,e){return t&&e.isVisible()}),!0)}getWidth(){return this.itemBlocks.reduce((function(t,e){return t+e.getWidth()}),0)}getNoTextWidth(){return this.itemBlocks.reduce((function(t,e){return t+e.getNoTextWidth()}),0)}updateVisible(t){this.itemBlocks.forEach((function(e){e.updateVisible(t)}))}tryAddItem(t){const e=this.itemBlocks[this.itemBlocks.length-1].item,i=e.groupName===t.groupName&&e.group===t.group&&e.adaptivePriority.value===t.adaptivePriority.value;return i&&this.addItem(t),i}}class O extends H{constructor(t,e){super(t),this.item=e}getName(){return"title"}getWidth(){return Y(this.getElement(),!1,false)}getElement(){return this.item.getElement()}}class G{constructor(t,e){this.element=t,this.toolbar=e,this.index=new u(-1),this.isVisible=new u(this.defaultIsVisible()),this.isVisible.subscribe((t=>{this.onIsVisibleChanged(t)}),!0)}defaultIsVisible(){return!0}getElement(){return this.element}updateVisible(t){this.isVisible.update(t)}onIsVisibleChanged(t){const e=this.getElement();e&&(t?this.show(e):this.hide(e))}show(t){t.classList.remove(C.ToolbarHiddenItem)}hide(t){t.classList.add(C.ToolbarHiddenItem)}}class U extends G{constructor(){super(...arguments),this.isDisplayed=new u(!0),this.text=new u(""),this.iconCssClass=new u("")}show(t){t.style.display=""}hide(t){t.style.display="none"}getGroupElement(){return null}}class z extends U{constructor(t,e,i){super(t,e),this.group=i,this.groupName=new u(""),this.adaptivePriority=new u(-1)}onIsVisibleChanged(t){super.onIsVisibleChanged(t),this.group.onItemVisibleChanged()}getElement(){return document.querySelector(et("data-dxtoolbar-item-id",this.id))}getParent(){const t=this.getElement();return t&&t.parentElement?t.parentElement:null}getGroupElement(){return this.group.getElement()}}class $ extends U{constructor(t,e){super(t,e)}defaultIsVisible(){return null}}class F extends G{constructor(t,e){super(t,e),this.items=[]}addItem(t){this.items.push(t)}onItemVisibleChanged(){if(0===this.items.length)return;const t=this.items.some((t=>t.isVisible.value));this.updateVisible(t)}getElement(){if(0===this.items.length)return null;const t=s(this.items[0].getElement(),et("data-dxtoolbar-group-id",this.toolbar.id));return t||this.items[0].getParent()}}class K extends G{constructor(t,e){super(null,t),this.elementSelector=e,this.hasTitle=new u(!1),this.text=new u(""),this.text.subscribe((t=>{this.hasTitle.update(null!=t&&""!==t)}))}getElement(){return document.querySelector(this.elementSelector)}}class J{constructor(t,e){this.element=t,this.id=e,this.items=[],this.itemMap=new Map,this.groupMap=new Map,this.canHideRootItems=!1,this.canCollapseToIcons=!1,this.minRootItems=0}}class Q{constructor(){this.isLoading=!0,this.isLayoutCalculated=!1,this.toolbar=null,this.layoutModel=null,this.reinitRequested=!1}init(e,n,r){this.isLayoutCalculated=!1;const l=r,a=e.dataset.dxtoolbarId,d=et("data-dxtoolbar-title-id",a),h=et("data-dxtoolbar-ellipsis-id",a),u=document.querySelector(h),c=this.toolbar=new J(e,a),m=c.groupMap;Array.from(n.items).forEach((t=>{const e=document.querySelector(et("data-dxtoolbar-item-id",t.id)),i=s(e,et("data-dxtoolbar-group-id",a));let o=null;m.has(i)&&(o=m.get(i)),o||(o=new F(i,c),m.set(i,o));const n=new z(e,c,o);n.text.update(t.text),n.groupName.update(t.groupName),n.adaptivePriority.update(t.adaptivePriority),n.iconCssClass.update(t.iconCssClass),n.isDisplayed.update(t.visible),n.index.update(t.index),n.id=t.id,c.itemMap.set(n.id,n),c.items.some((t=>t.index.value===n.index.value))||(o.addItem(n),c.items.push(n))})),c.canHideRootItems=n.canHideRootItems,c.canCollapseToIcons=n.canCollapseToIcons,c.minRootItems=n.minRootItems,c.itemSize=n.itemSize,c.renderMode=n.renderMode,c.itemSpacing=n.itemSpacingMode;const p=new x([]),g=new K(c,d);g.text.update(n.title),c.title=g,p.add(new O(c,g));const b=Array.from(m.values()),f=b.some((t=>t))?b.map((t=>t.items)).reduce(((t,e)=>t.concat(e))):[];p.addRange(this.getItemsBlocks(c,f));const y=new $(u,c);y.id=n.adaptiveMenuModel.id,p.add(new _(c,y)),c.ellipsisViewModel=y;const v=P.contextItem(p),w=this.layoutModel=new A((s=>{if(!this.isLayoutCalculated){this.isLayoutCalculated=!0;const t=c.element;o((()=>{const e=t.querySelector(".dxbl-btn-toolbar");this.updateControlStyles(c,Math.ceil(!this.isLoading&&e?e.offsetHeight:t.offsetHeight)),this.isLoading=!1}))}const n=c.element.querySelector(".dxbl-btn-toolbar")||c.element;if(s.stateName.indexOf(C.ToolbarNoItemText)>-1?t.addClassName(n,C.ToolbarNoItemText):t.removeClassName(n,C.ToolbarNoItemText),t.removeClassName(e,C.Loading),i(e))return;const r=c.items.concat(c.ellipsisViewModel).map((t=>({Id:t.id,IsVisible:t.isVisible.value})));l.invokeMethodAsync("OnModelUpdated",Array.from(r)).catch((function(t){i(e)||console.error(t)}))}));w.defaultLayer((function(t){switch(t.getName()){case"item":return P.fullWidthItem;case"title":return P.titleItem}return P.hiddenItem}),(()=>!0)),w.sequentialTransitionLayer(C.ToolbarHasEllipsis,(function(t){switch(t.getName()){case"ellipsis":return P.fullWidthSystemItem;case"item":return v}}),(()=>c.canHideRootItems&&c.minRootItems>0)),w.simultaneousTransitionLayer(C.ToolbarNoItemText,(function(t){switch(t.getName()){case"item":return P.noTextItem;case"ellipsis":return P.hiddenItem}}),(()=>c.canCollapseToIcons)),w.sequentialTransitionLayer(c.canCollapseToIcons?`${C.ToolbarNoItemText} ${C.ToolbarHasEllipsis}`:C.ToolbarHasEllipsis,(function(t){switch(t.getName()){case"item":return v;case"ellipsis":return P.fullWidthSystemItem}}),(()=>c.canHideRootItems)),w.initialize(p,c.element.querySelector(".dxbl-btn-toolbar")||c.element,(t=>{var e;this.height!==t.height&&(this.isLayoutCalculated=!1,this.height=t.height),null===(e=this.layoutModel)||void 0===e||e.updateLayout()}))}reinit(t,e){this.reinitRequested||(this.reinitRequested=!0,n((()=>{this.resetToDefault(),this.disposeModel(),n((()=>{this.reinitRequested=!1,this.init(t.mainElement,t,e)}))})))}resetToDefault(){var t;null===(t=this.layoutModel)||void 0===t||t.resetToDefault()}update(t,e){var i,s;if(!this.toolbar)return;let o=!1,n=!1;if(this.toolbar.canHideRootItems!==t.canHideRootItems&&(this.toolbar.canHideRootItems=t.canHideRootItems,o=!0),this.toolbar.canCollapseToIcons!==t.canCollapseToIcons&&(this.toolbar.canCollapseToIcons=t.canCollapseToIcons,o=!0),this.toolbar.minRootItems!==t.minRootItems&&(this.toolbar.minRootItems=t.minRootItems,o=!0),this.toolbar.itemSize!==t.itemSize&&(this.toolbar.itemSize=t.itemSize,n=!0),this.toolbar.renderMode!==t.renderMode&&(this.toolbar.renderMode=t.renderMode,n=!0),this.toolbar.itemSpacing!==t.itemSpacingMode&&(this.toolbar.itemSpacing=t.itemSpacingMode,n=!0),null===(i=this.toolbar.title)||void 0===i||i.text.update(t.title),!n){const e=Array.from(t.items).map((t=>t.id)),i=Array.from(this.toolbar.itemMap.values()).map((t=>t.id));n=!((r=e).length===(l=i).length&&r.every(((t,e)=>t===l[e])))}var r,l;n?this.reinit(t,e):(Array.from(t.items).forEach((t=>{if(!this.toolbar)return;const e=this.toolbar.itemMap.get(t.id);e&&(e.text.update(t.text),e.groupName.update(t.groupName),e.adaptivePriority.update(t.adaptivePriority),e.index.update(t.index),e.iconCssClass.update(t.iconCssClass),e.isDisplayed.update(t.visible))})),o&&(null===(s=this.layoutModel)||void 0===s||s.forceUpdate()))}disposeModel(){var t;null===(t=this.layoutModel)||void 0===t||t.dispose()}dispose(){this.disposeModel()}getItemsBlocks(t,e){return e.reduce(((e,i)=>e.group&&e.group.tryAddItem(i)?e:i.groupName.value?{group:e.blocks[e.blocks.length]=new q(t,i),blocks:e.blocks}:{group:null,blocks:e.blocks.concat([new j(t,i)])}),{blocks:[],group:null}).blocks.sort((function(t,e){return t.item.adaptivePriority.value-e.item.adaptivePriority.value})).map((function(t,e){return t.index=e,t}))}updateControlStyles(t,e){t.element.style.height=e+"px"}}function X(t){return[t.item.text,t.item.isDisplayed,t.item.iconCssClass]}function Y(e,i=!1,s=!1){if(!e)return 0;let o=Math.ceil(a(e)+(i?0:Z(e)));if(e.parentElement&&!s){if(e.parentElement.lastElementChild===e){const i=t.getCurrentStyle(e.parentElement);o+=t.pxToInt(i.marginRight)}if(e.parentElement.firstElementChild===e){const i=t.getCurrentStyle(e.parentElement);o+=t.pxToInt(i.marginLeft)}}return o}function Z(t){return d(t)}function tt(e){return t.hasClassName(e,"popout")}function et(t,e){return`[${t}=${e}]`}const it=new Map;function st(t,i,s){if(!(t=e(t)))return Promise.reject("failed");let o=it.get(t);o?o.update(i,s):(o=new Q,o.init(t,i,s),it.set(t,o));const n=t.querySelector(".dxbl-btn-toolbar")||t;return c(n),Promise.resolve("ok")}function ot(t){return s(t=e(t),it),Array.from(it.keys()).forEach((t=>{i(t)&&s(t,it)})),Promise.resolve("ok");function s(t,e){if(!t)return;const i=t.querySelector(".dxbl-btn-toolbar");i&&h(i);const s=e.get(t);null==s||s.dispose(),e.delete(t)}}customElements.define("dxbl-toolbar-menu-item",class extends D{constructor(){super(...arguments),this.boundOnButtonClick=this.onButtonClick.bind(this)}connectedCallback(){super.connectedCallback(),this.addEventListener("click",this.boundOnButtonClick)}disconnectedCallback(){this.removeEventListener("click",this.boundOnButtonClick),super.disconnectedCallback()}canHandlePointerDown(t){return m.containsInComposedPath(t,this)}onButtonClick(t){if(null===this.getAttribute("submit-form-on-click"))return;const e=this.getAttribute("data-dxtoolbar-container-id");if(e){const t=document.querySelector(`[data-dxtoolbar-id=${e}]`);if(t){const e=document.createElement("input");e.type="submit",e.hidden=!0,t.appendChild(e),e.click(),t.removeChild(e)}}}});const nt={init:st,dispose:ot};export{nt as default,ot as dispose,st as init};
