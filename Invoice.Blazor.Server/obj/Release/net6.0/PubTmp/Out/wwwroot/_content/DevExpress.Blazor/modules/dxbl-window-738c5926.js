import{_ as t}from"./_tslib-6e8ca86b.js";import{r as e,a as o,D as n}from"./dropdowncomponents-84415acc.js";import{D as r}from"./popupportal-85248f1b.js";import{C as i}from"./custom-events-helper-18f7786a.js";import{P as s}from"./point-9c6ab88a.js";import{D as a,P as l,a as c,H as p,T as h}from"./dx-html-element-pointer-events-helper-0f2b6602.js";import{P as d,C as m,c as u,a as g,b as f}from"./popup-e5c1aca3.js";import{n as w}from"./custom-element-bd7061f2.js";import{s as b,$ as y}from"./lit-element-b0a6fcba.js";import{e as v}from"./property-d3853089.js";import"./getPopupRootSingleton-f8347fe3.js";import"./branch-2ea85171.js";import"./capturemanager-91fa2b2d.js";import"./eventhelper-8570b930.js";import"./logicaltreehelper-15991dcb.js";import"./layouthelper-4b19d191.js";import"./rect-7fc5c2ef.js";import"./rafaction-bba7928b.js";import"./data-qa-utils-8be7c726.js";import"./thumb-b78dcc42.js";import"./events-interseptor-eeff27a3.js";import"./dom-166a04be.js";import"./transformhelper-ebad0156.js";import"./positiontracker-dba18a16.js";import"./supportcaptureelement-51f73fdc.js";import"./dx-ui-element-de378e9d.js";import"./lit-element-base-af247167.js";import"./nameof-factory-64d95f5b.js";var x,P,C,j;!function(t){t.Center="Center",t.Left="Left",t.Right="Right"}(C||(C={})),function(t){t.Top="Top",t.Center="Center",t.Bottom="Bottom"}(j||(j={}));let D=class extends r{};D=t([w("dxbl-window-dialog")],D);let E=class extends o{constructor(){super()}};E=t([w("dxbl-window-root")],E);class A{constructor(t,e){this.x=e.x,this.y=e.y}}class S extends CustomEvent{constructor(t,e){super(S.eventName,{detail:new A(t,e),bubbles:!0,composed:!0,cancelable:!1})}}S.eventName="dxbl-window.dragCompleted",i.register(S.eventName,(t=>t.detail));class R{constructor(t){this.x=t.x,this.y=t.y}}class T extends CustomEvent{constructor(t){super(T.eventName,{detail:new R(t),bubbles:!0,composed:!0,cancelable:!1})}}T.eventName="dxbl-window.dragStarted",i.register(T.eventName,(t=>t.detail));let z=x=class extends b{constructor(){super(),this.allowDrag=!1,this.pointerEventsHelper=new a(this)}connectedCallback(){super.connectedCallback();const t=this.closest("dxbl-window");if(!t)throw new Error("DxWindowHeader should be placed within a DxWindow");this.pointerEventsHelper.initialize(),this.allowDrag&&this.addEventListener(l.eventName,(e=>{const o=e,n=x.calculatePositionDelta(this,o.detail.source),r=x.createPoint(n,o.detail.source);let i=r;const s=()=>{t.positionX=i.x,t.positionY=i.y,a=requestAnimationFrame(s)};let a=requestAnimationFrame(s);const l=t=>{i=x.createPoint(n,t)};document.addEventListener("pointermove",l),this.addEventListener(c.eventName,(t=>{this.style.cursor="",this.style.userSelect="",cancelAnimationFrame(a),document.removeEventListener("pointermove",l);const e=x.createPoint(n,t.detail.source);this.shadowRoot.dispatchEvent(new S(r,e))}),{once:!0}),this.style.cursor="move",this.style.userSelect="none",this.shadowRoot.dispatchEvent(new T(r))}))}disconnectedCallback(){super.disconnectedCallback(),this.pointerEventsHelper.dispose()}get handlePointerEventsMode(){return p.Dragging}get handlePointerEventsTarget(){return this}get handlePointerEventsDelay(){return h}render(){return y`<slot></slot>`}static calculatePositionDelta(t,e){const o=t.getBoundingClientRect();return new s(Math.floor(e.clientX)-o.x,Math.floor(e.clientY)-o.y)}static createPoint(t,e){return new s(Math.floor(e.clientX)-t.x,Math.floor(e.clientY)-t.y)}};t([v({type:Boolean,attribute:"allow-drag",reflect:!1})],z.prototype,"allowDrag",void 0),z=x=t([w("dxbl-window-header")],z);let N=P=class extends n{constructor(){super(),this.sizeDirty=!1,this.positionYDirty=!1,this.positionXDirty=!1,this._settingsToApply=null,this.showAnchorElement=null,this.horizontalAlignment=C.Center,this.verticalAlignment=j.Center,this.closeOnEscape=!1,this.placement=d.Custom}get positionY(){return this.offset.y}set positionY(t){this.positionYDirty=!0,this.offset=new s(this.positionX||0,t||0)}get positionX(){return this.offset.x}set positionX(t){this.positionXDirty=!0,this.offset=new s(t||0,this.positionY||0)}move(t){return new Promise(((e,o)=>{requestAnimationFrame((()=>{this._settingsToApply=t,this.forceReposition(),e()}))}))}showAt(t){return new Promise(((e,o)=>{this._settingsToApply=t,requestAnimationFrame((()=>{super.show(),e()}))}))}show(){this.showAt(this._settingsToApply).catch((t=>{}))}static getPlacementTarget(t){if(null!==t){if(null!==t.targetReference&&t.targetReference instanceof HTMLElement)return t.targetReference;if(null!==t.targetSelector){const e=document.querySelector(t.targetSelector);if(null!==e)return e}}return document.body}static getShowAtBox(t){return null===t?null:null!==t.targetReference&&t.targetReference instanceof HTMLElement?P.getElementTopLeftPoint(t.targetReference):null!==t.targetSelector?P.getElementTopLeftPoint(document.querySelector(t.targetSelector)):t.targetPoint}static getElementTopLeftPoint(t){if(null===t)return null;const e=t.getBoundingClientRect();return new s(e.left,e.top)}canProcessEscapeKeyDown(){return this.closeOnEscape}renderTemplate(){return y`
            <dxbl-branch
                id="branch"
                branch-id="${this.branchId}"
                parent-branch-id="${this.parentBranchId}"
                type="${this.branchType}"
                style="${this.dragCssStyle}">
                <dxbl-window-root
                    id="root"
                    style="${this.rootCssStyle}"
                    ?resizing="${this.resizing}"
                    drop-opposite="${this.actualDropOpposite}"
                    drop-direction="${this.actualDropDirection}"
                    drop-alignment="${this.actualDropAlignment}">
                    ${this.renderDefaultSlot()}
                    ${this.renderAdditionalSlots()}
                    ${this.renderBridgeSlot()}
                </dxbl-window-root>
            </dxbl-branch>
        `}raiseResizeCompleted(t,e){this.sizeDirty=!0,super.raiseResizeCompleted(t,e)}processCustomPlacement(t,e){if(this.positionXDirty||this.positionYDirty||this.isInDragOperation||this.sizeDirty)return null;const o=this._settingsToApply;return o?o.targetPoint?[new m(o.targetPoint,u.None,!1,g.Near,f.bottom)]:this.calcCustomPlacements(o):null}calcCustomPlacements(t){return[new m(this.calcShowPoint(t),u.None,!1,g.Near,f.bottom)]}calcShowPoint(t){const e=P.getPlacementTarget(t),o=this.getBoundingClientRect(),n=e.getBoundingClientRect(),r=document.body.getBoundingClientRect(),i=this.calcShowXPoint(o,n),a=this.calcShowYPoint(o,n),l=r.y+r.height-o.height;return new s(Math.max(0,i-Math.max(0,i-(r.x+r.width-o.width))),Math.max(0,a-Math.max(0,a-l)))}calcShowXPoint(t,e){return Math.floor((()=>{switch(this.horizontalAlignment){case C.Left:return e.x;case C.Right:return e.x+e.width-t.width;case C.Center:return e.x+e.width/2-t.width/2}throw new Error("calcShowXPoint not supported for horizontalAlignment:"+this.horizontalAlignment)})())}calcShowYPoint(t,e){return Math.floor((()=>{switch(this.verticalAlignment){case j.Top:return e.y;case j.Bottom:return e.y+e.height-t.height;case j.Center:return e.y+e.height/2-t.height/2}throw new Error("calcShowYPoint not supported for horizontalAlignment:"+this.verticalAlignment)})())}};function B(t){if(!t)throw new Error("failed");return t}t([v({type:C,attribute:"horizontal-alignment",reflect:!1})],N.prototype,"horizontalAlignment",void 0),t([v({type:C,attribute:"vertical-alignment",reflect:!1})],N.prototype,"verticalAlignment",void 0),t([v({type:Number,attribute:"position-y",reflect:!1})],N.prototype,"positionY",null),t([v({type:Number,attribute:"position-x",reflect:!1})],N.prototype,"positionX",null),t([v({type:Boolean,attribute:"close-on-escape"})],N.prototype,"closeOnEscape",void 0),N=P=t([w("dxbl-window")],N);export{N as DxWindow,S as WindowDragCompletedEvent,T as WindowDragStartedEvent,B as getWindowRef};
